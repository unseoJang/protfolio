<!doctype html>
<html>
	<head>
		<title>타자연습</title>
		<meta name="generator" content="editplus">
		<meta name="author" content="">
		<meta name="keywords" content="">
		<meta name="description" content="">		

		<style>
			body {background:#efefed;}
			#wrap {margin:40px auto 0;width:600px;}

			.typing .string_box {}
			.typing .string_box > div,
			.typing .string_box > div input {background:#fff;border:1px solid #ccc;font-size:14px;text-align:center;line-height:32px;padding:4px 20px;}
			.typing .string_box .view {color:#666;margin:0 0 4px;}
			.typing .string_box .user {position:relative;min-height:32px;}
			.typing .string_box .user input {background:transparent;border:0 none;box-sizing:border-box;position:absolute;left:0;top:0;width:100%;height:100%;}

			.status {font-size:12px;}
			.status ul {padding:0;margin:0;}
			.status ul li {list-style-type:none;overflow:hidden;padding:8px 12px 0;}
			.status ul li > div {float:left;line-height:32px;height:32px;}
			.status ul li .tit {color:#666;overflow:hidden;width:10%;}
			.status ul li .progress {float:left;width:90%;}
			.status ul li .progress_bar {background:#fff;border:1px solid #999;border-radius:6px;box-sizing:border-box;overflow:hidden;position:relative;width:95%;height:12px;margin:10px 0;}
			.status ul li .progress_bar span {background:pink;position:absolute;left:0;top:0;width:10%;height:100%;}
			.status ul li .progress > span {float:left;width:5%;}
		</style>
		<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
		<script>
			/*
				기능
				0. 랜덤으로 문장 뿌려주기
				1. 사용자의 키보드 입력
				2. 키코드 들어올 때마다 확인
				3. 틀리면 빨간색 맞을때까지 빨간색
				4. 한문장을 정확히 쓴 후 엔터치면 정확도/평균정확도/현재속도/최고속도 측정
			*/
			$(document).ready(function(){
				viewArea = $('.typing .string_box .view');
				inputArea = $('.typing .user input');
				init();


				/* 키보드를 누를 때 마다 체크 */
				$(window).keyup(function(){
					inputStr = inputArea.val();
					if(!result){
						strChk();		
					}else {
						if(event.keyCode == 13){ // enter 클릭.
							init();
						}
					}
				});
			});

			/* 초기화 함수 */
			var viewArea, inputArea;
			function init(){
				result = false;
				inputArea.val('');
				randomStr();
			}

			/* 랜덤으로 문장 뿌려주기 */
			var randomStrNum;
			function randomStr(){
				randomStrNum = Math.floor(Math.random() * newStr.length); //0~(lentgh-1);
				viewArea.append(newStr[randomStrNum]);
			}
			var newStr = [
				'동해물과 백두산이 마르고 닳도록',
				'하느님이 보우하사 우리 나라 만세',
				'무궁화 삼천리 화려강산',
				'대한사람 대한으로 길이 보전하세'
			];

			/* 한 글자, 한 글자 체크하기 */
			var inStr,		// 랜덤하게 노출된 스트링
				inputStr;	// 사용자가 입력한 스트링
			function strChk(){
				var x='';
				inStr = newStr[randomStrNum];
				for(var i=0;i<inStr.length;i++){
					if(inStr.substring(i,i+1)!=inputStr.substring(i,i+1) && i<inputStr.length){
						x+="<span style='color:red'>"+inStr.substring(i,i+1)+"</span>";
					}else {
						x+=inStr.substring(i,i+1);
					}
				}
				viewArea.empty().append(x);
				strResult();
			}

			/* 스트링 올바른지 체크하기 */
			var result = false; // 맞으면 true, 틀리면 false
			function strResult(){
				if(inStr == inputStr) result = true;
				else result = false;
				console.log(result)
				return result;
			}
			
		</script>
	</head>
	<body>
		<div id="wrap">
			<div class="typing">
				<div class="string_box">
					<div class="view"></div>
					<div class="user"><input type="text" /></div>
				</div>
				<div class="status">
					<ul>
						<li>
							<div class="tit">정확도</div>
							<div class="progress">
								<div class="progress_bar">
									<span style="width:10%;"></span>
								</div>
								<span class="txt">10%</span>
							</div>
						</li>
						<li>
							<div class="tit">평균 정확도</div>
							<div class="progress">
								<div class="progress_bar">
									<span style="width:10%;"></span>
								</div>
								<span class="txt">10%</span>
							</div>
						</li>
						<li>
							<div class="tit">현재속도</div>
							<div class="progress">
								<div class="progress_bar">
									<span style="width:10%;"></span>
								</div>
								<span class="txt">23타/분</span>
							</div>
						</li>
						<li>
							<div class="tit">최고 속도</div>
							<div class="progress">
								<div class="progress_bar">
									<span style="width:10%;"></span>
								</div>
								<span class="txt">23타/분</span>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</body>
</html> 